## Monarch Counter: An Automated Pipeline to Count Monarch Butterflies in Dense Clusters

![Monarch Butterflies](/images/monarchs.png?raw=true)

Every year, billions of animals undertake long-distance migrations to leave deteriorating habitats, escape parasites and predators, and benefit from available resources in multiple regions. Migrations across continents are one of the most fascinating phenomena that exist in nature. One of the most spectacular migrations is undertaken by the monarch butterfly in North America, with up to hundreds of millions of monarchs flying up to 3,000 miles to reach their overwintering grounds in Central Mexico. Monarch caterpillars are specialist feeders on milkweed plants, and breed between March and October across their 4.5 million km2 breeding range spanning the United States and southern Canada. Upon milkweed deterioration, diminishing daylight, and decreasing temperature, monarchs embark on their journey south to overwinter in Oyamel forests in the states of Mexico and Michoacán, where temperatures are mild enough to prevent freezing, but low enough to prevent high activity and premature depletion of lipid reserves. In early spring, monarchs mate and fly north to recolonize their breeding grounds over 2-4 successive generations.

Monarchs have garnered much attention from the research community and public because of conservation concerns. Indeed, studies have suggested that the monarch population has undergone a drastic decline over the past three decades, with some estimates of a greater than 80% decline between a high in the winter of 1996–1997 and a low in the winter of 2014–2015. Moreover, some estimates indicate that the butterflies face quasi-extinction of 11–57% in the next 20 years. A major issue with these studies is that they are entirely based on estimates of occupied hectares in the overwintering sites. Thus, instead of actual population censuses, monarch population size has been estimated based on the number of hectares occupied by overwintering monarch clusters. Rough estimates of numbers of monarchs per hectare vary widely, and have been cited to range from 7 and 61 million. 

Arguably, the most important step in conserving a species is to monitor its population. While this step might seem relatively straightforward for many species around the globe, it is particularly challenging to design principled methodologies to count and track monarch butterflies. While many citizen science monitoring projects are based on standardized efforts of monarch sightings during the breeding and migration season, it is the overwintering population that could provide the most accurate population estimates. We discuss [a deep learning architecture](https://github.com/monarch-counter/monarch-counter) that can count monarch butterflies from images by converting the images into a density map, and then learning a function that models the conditional distribution of the density map given the original image. We also release [an open source dataset](https://github.com/monarch-counter/data-public) of annotated images of monarch butterflies that can be used by other researchers to create automated approaches to count butterflies. Finally, we also create [an open source tool](https://colab.research.google.com/drive/1_oEcWgO-qgFwFh7HVlkFIwGoP17QjKOe?usp=sharing) that can be readily used by forest rangers, conservationists, and ecologists to estimate the counts of monarch butterflies. To the best of our knowledge, this paper creates the first open-source dataset consisting of annotated images of monarch butterflies as well as the first open source automated counting tool for the conservation of the species.
